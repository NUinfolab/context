var core=require("kango/core"),utils=require("kango/utils"),func=utils.func,object=utils.object,BrowserTab=require("kango/browser").BrowserTab;function MessageRouter(){MessageRouterBase.call(this);chrome.runtime.onMessage.addListener(func.bind(this._onMessage,this))}
MessageRouter.prototype=object.extend(MessageRouterBase,{_onMessage:function(a,d){var b={name:a.name,data:a.data,origin:a.origin,target:null,source:null};if("tab"==a.origin){var c=d.tab;"undefined"==typeof c&&(c={id:-1,url:"",title:"Hidden Tab"});b.source=b.target=new BrowserTab(c)}this.fireMessageEvent("message",b)}});module.exports=new MessageRouter;
