var utils=require("kango/utils"),object=utils.object,func=utils.func;
function TabApiProxy(k){var a=require("kango/console"),f=require("kango/storage").storage,c=require("kango/i18n"),h=require("kango/invoke_async"),e=require("kango/message_target"),g=[];this.xhr={send:function(){var b=require("kango/xhr");return b.send.apply(b,arguments)}};this.console={log:function(){return a.log.apply(a,arguments)},warn:function(){return a.warn.apply(a,arguments)},error:function(){return a.error.apply(a,arguments)}};this.browser={getName:function(){return require("kango/browser").getName()}};
this.io={getResourceUrl:function(b){return require("kango/io").getResourceUrl(b)}};this.tab={isPrivate:function(){return k.isPrivate()}};this.storage={setItem:function(b,d){return f.setItem(b,d)},getItem:function(b){return f.getItem(b)},removeItem:function(b){return f.removeItem(b)},getKeys:function(){return f.getKeys()},clear:function(){return f.clear()}};this.i18n={getMessage:function(){return c.getMessage.apply(c,arguments)},getMessages:function(){return c.getMessages.apply(c,arguments)},getCurrentLocale:function(){return c.getCurrentLocale.apply(c,
arguments)}};this.getExtensionInfo=function(){return require("kango/extension_info").getRawData()};var n=this.dispatchMessage=function(b,d){var m=require("kango/messaging"),a={name:b,data:null!=d?object.sanitize(d):d,origin:"tab",source:k,target:k};return m.dispatchMessageEx(a)},l=this.addEventListener=function(b,d){if("message"==b){for(var a=0;a<g.length;a++)if(g[a]==d)return;g.push(d)}};this.fireEvent=function(b,a){if("message"==b){a.source&&a.target||(a.source=a.target=this);for(var c=0;c<g.length;c++)g[c](a)}};
h=new h(l,n,utils.func.invoke,func.bind(a.log,a));this.invokeAsync=h.invokeAsync;this.invokeAsyncCallback=h.invokeAsyncCallback;e=new e(l);this.addMessageListener=func.bind(e.addMessageListener,e);this.removeMessageListener=func.bind(e.removeMessageListener,e)};
